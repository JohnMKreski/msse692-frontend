<div class="app-header__inner">
    <div class="app-header__brand">Ark Valley Events<span *ngIf="isAdmin" class="admin-indicator"> | ADMIN</span></div>
    <nav aria-label="Primary" class="primary-nav">
        <ul>
            <li><a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" ariaCurrentWhenActive="page">Home</a></li>
            <li><a routerLink="/events" routerLinkActive="active">Events</a></li>
            <li><a routerLink="/test-api" routerLinkActive="active">Test API</a></li>
        </ul>
    </nav>
    <div class="account-area" *ngIf="user; else loggedOut">
        <button class="user-menu__button" (click)="toggleMenu()" aria-haspopup="true" [attr.aria-expanded]="menuOpen" (keydown.escape)="closeMenu()">
            {{ profileName || (user.displayName || 'Account') }}
            <span class="visually-hidden" *ngIf="menuOpen">menu expanded</span>
        </button>
        <div class="user-menu__panel" *ngIf="menuOpen" role="menu">
            <div class="user-menu__identity" role="presentation">
                <strong>{{ profileName || user.displayName || user.email || 'Signed in' }}</strong>
                <div *ngIf="user.email && (user.displayName || profileName)">{{ user.email }}</div>
            </div>
            <a routerLink="/profile" role="menuitem" (click)="closeMenu()" routerLinkActive="active">Profile</a>
            <a routerLink="/settings" role="menuitem" (click)="closeMenu()" routerLinkActive="active">Settings</a>
            <a *ngIf="isAdmin" routerLink="/admin" role="menuitem" (click)="closeMenu()" routerLinkActive="active">Admin</a>
            <a *ngIf="isEditor" routerLink="/editor/events" role="menuitem" (click)="closeMenu()" routerLinkActive="active">Manage Events</a>
            <button type="button" role="menuitem" (click)="logoutAndClose()">Logout</button>
        </div>
    </div>
    <ng-template #loggedOut>
        <a routerLink="/login" routerLinkActive="active" class="login-link">Login</a>
    </ng-template>
</div>
