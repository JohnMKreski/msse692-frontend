:host {
    display: block;
}
.events-page {
    /* Further tightened top & bottom padding to align with compact calendar header */
    padding: .5rem 1.1rem 1.5rem;
    max-width: 1180px; /* slight width reduction for tighter feel */
    margin: 0 auto;
}
 .page-title {
     margin: 0 0 .75rem;
     font-size: 1.9rem;
     font-weight: 600;
     letter-spacing: .5px;
 }
.page-header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: .75rem;
    margin-bottom: .35rem; /* tighter below header */
}
.page-header .page-title { margin: 0; }
.refresh-btn {
    background: #1f6feb;
    color: #fff;
    border: none;
    padding: .42rem .8rem; /* slightly reduced vertical space */
    border-radius: 6px;
    font-size: .72rem;
    font-weight: 600;
    letter-spacing: .5px;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,.12);
    transition: background .15s ease, box-shadow .15s ease;
    line-height: 1.05;
}
.refresh-btn:hover:not(:disabled) { background: #2583ff; }
.refresh-btn:active:not(:disabled) { background: #1d5fbf; box-shadow: 0 1px 2px rgba(0,0,0,.18); }
.refresh-btn:disabled { opacity: .55; cursor: default; }
 .calendar-wrapper {
     background: #ffffff;
     border: 1px solid #d1d5db;
     border-radius: 10px;
     padding: .4rem .5rem .65rem; /* reduced internal padding */
    box-shadow: 0 2px 4px rgba(0,0,0,.04);
    height: 770px; /* expanded to fit 6-row month view without vertical scroll */
     display: flex;
     flex-direction: column;
    overflow: visible; /* allow tooltips & full month grid without clipping */
  }

/* Allow FullCalendar to flex within the frame */
.calendar-wrapper ::ng-deep .fc {
    flex: 1 1 auto;
    min-height: 0;
    display: flex;
    flex-direction: column;
}
.calendar-wrapper ::ng-deep .fc-view-harness {
    flex: 1 1 auto;
    min-height: 0;
    display: flex;
    flex-direction: column;
}
.calendar-wrapper ::ng-deep .fc-view-harness-active {
    flex: 1 1 auto;
    min-height: 0;
}
/* Enable vertical scroll ONLY for time-based (week/day) and list views */
.calendar-wrapper ::ng-deep .fc-timegrid-body,
.calendar-wrapper ::ng-deep .fc-list-scroller {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    overscroll-behavior: contain;
    scrollbar-gutter: stable;
    padding-bottom: .5rem;
}

/* Month (dayGrid) view should remain static (no vertical scroll) */
.calendar-wrapper ::ng-deep .fc-daygrid,
.calendar-wrapper ::ng-deep .fc-daygrid .fc-scroller,
.calendar-wrapper ::ng-deep .fc-daygrid-body {
    overflow: visible !important;
}

/* Ensure harness and view can shrink horizontally to avoid x scroll */
.calendar-wrapper ::ng-deep .fc-view-harness,
.calendar-wrapper ::ng-deep .fc-view-harness-active,
.calendar-wrapper ::ng-deep .fc {
    min-width: 0;
}

/* Timegrid specific body sometimes forces horizontal scroll; constrain it */
.calendar-wrapper ::ng-deep .fc-timegrid-body {
    width: 100% !important;
}

/* Daygrid event rows: allow vertical overflow, but hide accidental horizontal overflow */
.calendar-wrapper ::ng-deep .fc-daygrid-body {
    overflow-x: hidden;
}

/* Prevent horizontal overflow jitter */
.calendar-wrapper ::ng-deep .fc-scroller {
    margin-right: 0;
}

@media (max-width: 900px) {
    .calendar-wrapper { height: 620px; }
}
@media (max-width: 600px) {
    .calendar-wrapper { height: 520px; }
}
/* Removed duplicate early legend styles */

/* Quick, styled tooltip using data-tooltip attribute */
:host ::ng-deep .fc .fc-daygrid-event,
:host ::ng-deep .fc .fc-timegrid-event,
:host ::ng-deep .fc .fc-list-event {
    // position: relative;
    cursor: pointer; /* indicate clickability for calendar events */
}

:host ::ng-deep .fc .fc-daygrid-event[data-tooltip]::after,
:host ::ng-deep .fc .fc-timegrid-event[data-tooltip]::after,
:host ::ng-deep .fc .fc-list-event[data-tooltip]::after {
    content: attr(data-tooltip);
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(8px);
    z-index: 1000;
    width: 320px;
    background: var(--mat-sys-surface-container-high, rgba(33,33,33,0.95));
    color: var(--mat-sys-on-surface, #fff);
    border: 1px solid rgba(0,0,0,0.2);
    padding: 6px 8px;
    border-radius: 6px;
    white-space: pre-line;
    overflow-wrap: anywhere;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    pointer-events: none;
    opacity: 0;
    transition: opacity 200ms ease-out, transform 80ms ease-out;
    font-size: 12px;
    line-height: 1.2;
    max-width: 360px;
}

/* Allow tooltips to escape default overflow clipping in day grid */
:host ::ng-deep .fc .fc-daygrid-day-events {
    overflow: visible; 
}

/* Ensure the hovered event sits above siblings so its pseudo-element isn't obscured */
:host ::ng-deep .fc .fc-daygrid-event,
:host ::ng-deep .fc .fc-timegrid-event,
:host ::ng-deep .fc .fc-list-event {
    z-index: 2; 
}

:host ::ng-deep .fc .fc-daygrid-event:hover,
:host ::ng-deep .fc .fc-timegrid-event:hover,
:host ::ng-deep .fc .fc-list-event:hover {
    z-index: 5; 
}

:host ::ng-deep .fc .fc-daygrid-event[data-tooltip]:hover::after,
:host ::ng-deep .fc .fc-timegrid-event[data-tooltip]:hover::after,
:host ::ng-deep .fc .fc-list-event[data-tooltip]:hover::after {
    opacity: 1;
    transform: translateX(-50%) translateY(12px);
}

/* Minimal styling retained: rely on inline event color assignments. */

/* Legends for event types & statuses */
.legend-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1.1rem;
    margin: .25rem 0 1.25rem;
}
.legend {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: .45rem .9rem;
    font-size: .7rem;
    background: #ffffff;
    border: 1px solid #c3c7cb;
    padding: .5rem .75rem;
    border-radius: 6px;
}
.legend-title {
    font-weight: 600;
    margin-right: .5rem;
    text-transform: uppercase;
    letter-spacing: .5px;
    color: #111827;
}
.legend-item {
    display: inline-flex;
    align-items: center;
    gap: .35rem;
    color: #374151;
}
.color-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    box-shadow: 0 0 0 1px #00000022;
}

@media (max-width: 600px) {
    .legend-container {
        flex-direction: column;
        gap: 0.75rem;
    }
    .legend {
        font-size: 0.7rem;
        gap: 0.4rem 0.75rem;
    }
}
